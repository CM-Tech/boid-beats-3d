import{S as e,C as t,M as a,P as r,a as n,W as i,R as o,D as u,F as s,N as l,b as d,c,d as m,e as v,f as h,s as p,H as f,V as g,g as w,h as x,B as T,i as y}from"./vendor.192db521.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const r=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,i)=>{const o=new URL(e,r);if(self[t].moduleMap[o])return a(self[t].moduleMap[o]);const u=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),s=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(u),onerror(){i(new Error(`Failed to import: ${e}`)),n(s)},onload(){a(self[t].moduleMap[o]),n(s)}});document.head.appendChild(s)})),self[t].moduleMap={}}}("assets/");var b,S,M,F,D,R=function(c,m,v){this.variables=[],this.currentTextureIndex=0;var h=s,p=new e,f=new t;f.position.z=1;var g={passThruTexture:{value:null}},w=y("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",g),x=new a(new r(2,2),w);function T(e){e.defines.resolution="vec2( "+c.toFixed(1)+", "+m.toFixed(1)+" )"}function y(e,t){var a=new n({uniforms:t=t||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:e});return T(a),a}p.add(x),this.setDataType=function(e){return h=e,this},this.addVariable=function(e,t,a){var r={name:e,initialValueTexture:a,material:this.createShaderMaterial(t),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:l,magFilter:l};return this.variables.push(r),r},this.setVariableDependencies=function(e,t){e.dependencies=t},this.init=function(){if(!v.capabilities.isWebGL2&&!v.extensions.get("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===v.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var e=0;e<this.variables.length;e++){var t=this.variables[e];t.renderTargets[0]=this.createRenderTarget(c,m,t.wrapS,t.wrapT,t.minFilter,t.magFilter),t.renderTargets[1]=this.createRenderTarget(c,m,t.wrapS,t.wrapT,t.minFilter,t.magFilter),this.renderTexture(t.initialValueTexture,t.renderTargets[0]),this.renderTexture(t.initialValueTexture,t.renderTargets[1]);var a=t.material,r=a.uniforms;if(null!==t.dependencies)for(var n=0;n<t.dependencies.length;n++){var i=t.dependencies[n];if(i.name!==t.name){for(var o=!1,u=0;u<this.variables.length;u++)if(i.name===this.variables[u].name){o=!0;break}if(!o)return"Variable dependency not found. Variable="+t.name+", dependency="+i.name}r[i.name]={value:null},a.fragmentShader="\nuniform sampler2D "+i.name+";\n"+a.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var e=this.currentTextureIndex,t=0===this.currentTextureIndex?1:0,a=0,r=this.variables.length;a<r;a++){var n=this.variables[a];if(null!==n.dependencies)for(var i=n.material.uniforms,o=0,u=n.dependencies.length;o<u;o++){var s=n.dependencies[o];i[s.name].value=s.renderTargets[e].texture}this.doRenderTarget(n.material,n.renderTargets[t])}this.currentTextureIndex=t},this.getCurrentRenderTarget=function(e){return e.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(e){return e.renderTargets[0===this.currentTextureIndex?1:0]},this.addResolutionDefine=T,this.createShaderMaterial=y,this.createRenderTarget=function(e,t,a,r,n,u){return new i(e=e||c,t=t||m,{wrapS:a=a||d,wrapT:r=r||d,minFilter:n=n||l,magFilter:u=u||l,format:o,type:h,depthBuffer:!1})},this.createTexture=function(){var e=new Float32Array(c*m*4);return new u(e,c,m,o,s)},this.renderTexture=function(e,t){g.passThruTexture.value=e,this.doRenderTarget(w,t),g.passThruTexture.value=null},this.doRenderTarget=function(e,t){var a=v.getRenderTarget();x.material=e,v.setRenderTarget(t),v.render(p,f),x.material=w,v.setRenderTarget(a)}},C=function(){var e=9216;T.call(this);var t=new y(new Float32Array(27648),3),a=new y(new Float32Array(27648),3),r=new y(new Float32Array(18432),2),n=new y(new Float32Array(e),1);this.setAttribute("position",t),this.setAttribute("birdColor",a),this.setAttribute("reference",r),this.setAttribute("birdVertex",n);var i=0;function o(){for(var e=0;e<arguments.length;e++)t.array[i++]=arguments[e]}for(var u=0;u<1024;u++)o(0,-0,-20,0,4,-20,0,0,30),o(0,0,-15,-20,0,0,0,0,15),o(0,0,15,20,0,0,0,0,-15);for(i=0;i<9216;i++){var s=~~(i/3),l=s%32/32,d=~~(s/32)/32,c=new m(4473924+~~(i/9)/1024*6710886);a.array[3*i+0]=c.r,a.array[3*i+1]=c.g,a.array[3*i+2]=c.b,r.array[2*i]=l,r.array[2*i+1]=d,n.array[i]=i%9}this.scale(.2,.2,.2)};C.prototype=Object.create(T.prototype);var A,V,I,E,B,_,P,U,L,W=0,O=0,j=window.innerWidth/2,k=window.innerHeight/2,H=performance.now();function z(e){var t=e||1024;this.spectrum=[],this.volume=this.vol=0,this.peak_volume=0;var a=this;this.analyser=null,this.animationId=null,this.getRMS=function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a]*e[a];return t/=e.length,t=Math.sqrt(t)},this.init=function(){try{e=new AudioContext,navigator.mediaDevices.getUserMedia({audio:!0}).then((function(r){var n=document.getElementById("mic-message");n&&n.classList.add("hidden"),function(e,r){var n=r.createAnalyser();function i(){a.spectrum=new Uint8Array(n.frequencyBinCount),n.getByteFrequencyData(a.spectrum),a.vol=a.getRMS(a.spectrum),a.vol>a.peak_volume&&(a.peak_volume=a.vol),a.volume=a.vol,a.animationId=requestAnimationFrame(i)}n.smoothingTimeConstant=.2,n.fftSize=t,a.analyser=n,r.createMediaStreamSource(e).connect(n),i()}(r,e)})).catch((function(e){console.error("Microphone access denied:",e);var t=document.getElementById("mic-message");t&&(t.textContent="Microphone access denied. Please refresh and allow access.")}))}catch(r){console.error(r),alert("Web Audio API could not be called, check that the url starts with https:// and not http://")}var e}}window.Microphone=z;var q=100*Math.floor(250/(1e3/60));let N=[],$=[];for(var X=0;X<256;X++)N.push(0),$.push(0);let Y=N.slice();var G=[];for(X=0;X<q;X++){var J=new Uint8Array(256);G.push(J)}let K=new Uint8Array(256).fill(0);function Q(){j=window.innerWidth/2,k=window.innerHeight/2,M.aspect=window.innerWidth/window.innerHeight,M.updateProjectionMatrix(),D.setSize(window.innerWidth,window.innerHeight)}function Z(e){W=e.clientX-j,O=e.clientY-k}function ee(e){1===e.touches.length&&(e.preventDefault(),W=e.touches[0].pageX-j,O=e.touches[0].pageY-k)}function te(e){1===e.touches.length&&(e.preventDefault(),W=e.touches[0].pageX-j,O=e.touches[0].pageY-k)}(L=new z(512)).init(),function(){b=document.createElement("div"),document.body.appendChild(b),(M=new c(75,window.innerWidth/window.innerHeight,1,3e3)).position.z=500,(F=new e).background=new m(0),F.fog=new v(0,100,1e3),(D=new h).setPixelRatio(window.devicePixelRatio),D.setSize(window.innerWidth,window.innerHeight),b.appendChild(D.domElement),function(){A=new R(32,32,D),function(){return!!navigator.userAgent.match(/Safari/i)&&!navigator.userAgent.match(/Chrome/i)}()&&A.setDataType(f);var e=A.createTexture(),t=A.createTexture(),a=A.createTexture();(function(e){for(var t=e.image.data,a=0,r=t.length;a<r;a+=4){var n=800*Math.random()-400,i=800*Math.random()-400,o=800*Math.random()-400;t[a+0]=n,t[a+1]=i,t[a+2]=o,t[a+3]=1}})(e),function(e){for(var t=e.image.data,a=0,r=t.length;a<r;a+=4){var n=Math.random()-.5,i=Math.random()-.5,o=Math.random()-.5;t[a+0]=1*n,t[a+1]=1*i,t[a+2]=1*o,t[a+3]=1}}(t),function(e){for(var t=e.image.data,a=0,r=t.length;a<r;a+=4){var n=Math.random(),i=Math.random(),o=Math.random();t[a+0]=n,t[a+1]=i,t[a+2]=o,t[a+3]=1}}(a),V=A.addVariable("textureVelocity",document.getElementById("fragmentShaderVelocity").textContent,t),I=A.addVariable("texturePosition",document.getElementById("fragmentShaderPosition").textContent,e),E=A.addVariable("textureColor",document.getElementById("fragmentShaderColor").textContent,a),A.setVariableDependencies(V,[I,V,E]),A.setVariableDependencies(I,[I,V]),A.setVariableDependencies(E,[I,V,E]),B=I.material.uniforms,_=V.material.uniforms,P=E.material.uniforms,B.time={value:0},B.delta={value:0},_.time={value:1},_.delta={value:0},_.testing={value:1},_.separationDistance={value:1},_.alignmentDistance={value:1},_.cohesionDistance={value:1},_.freedomFactor={value:1},_.predator={value:new g},_.music={value:K},_.lmusic={value:K},V.material.defines.BOUNDS=800..toFixed(2),P.time={value:1},P.delta={value:0},P.testing={value:1},P.separationDistance={value:1},P.alignmentDistance={value:1},P.cohesionDistance={value:1},P.freedomFactor={value:1},P.music={value:K},P.lmusic={value:K},P.predator={value:new g},E.material.defines.BOUNDS=800..toFixed(2),V.wrapS=w,V.wrapT=w,I.wrapS=w,I.wrapT=w,E.wrapS=w,E.wrapT=w;var r=A.init();null!==r&&console.error(r)}(),S=new p,document.addEventListener("mousemove",Z,!1),document.addEventListener("touchstart",ee,!1),document.addEventListener("touchmove",te,!1),window.addEventListener("resize",Q,!1);var t={separation:20,alignment:20,cohesion:20,freedom:.75};_.separationDistance.value=t.separation,_.alignmentDistance.value=t.alignment,_.cohesionDistance.value=t.cohesion,_.freedomFactor.value=t.freedom,P.separationDistance.value=t.separation,P.alignmentDistance.value=t.alignment,P.cohesionDistance.value=t.cohesion,P.freedomFactor.value=t.freedom,function(){var e=new C;U={color:{value:new m(16720384)},texturePosition:{value:null},textureVelocity:{value:null},textureColor:{value:null},time:{value:1},delta:{value:0},music:{value:K},lmusic:{value:K}};var t=new n({uniforms:U,vertexShader:document.getElementById("birdVS").textContent,fragmentShader:document.getElementById("birdFS").textContent,side:x}),r=new a(e,t);r.rotation.y=Math.PI/2,r.matrixAutoUpdate=!1,r.updateMatrix(),F.add(r)}()}(),function e(){requestAnimationFrame(e),function(){L&&256===L.spectrum.length&&(K=L.spectrum.slice());for(var e=0;e<0;e++)K=K.map(((e,t)=>{var a=[e];return t<255&&a.push(K[t+1]),t>0&&a.push(K[t-1]),Math.max(...a)}));for(G.unshift(K.slice()),G.pop(),Y=[],e=0;e<256;e++){N[e]=0,$[e]=0,Y[e]=0;for(var t=0;t<q;t++)$[e]=Math.max(G[t][e],$[e]);for(N[e]=G[0][e]/$[e]*256,t=0;t<q/100;t++)Y[e]+=G[t][e]/q*100/$[e]*256}}(),function(){var e=performance.now(),t=(e-H)/1e3;t>1&&(t=1);H=e;let a=[...K].map(((e,t)=>[Y[t]+K[t],t]));a.sort(((e,t)=>t[0]-e[0])),a=a.map((e=>{let t=K[e[1]],a=Y[e[1]];return[256*Math.max(0,(t-a+1e-4)/(t/2+a/2+1e-4))*2,e[1]]}));const r=a.slice(0,32).sort(((e,t)=>e[1]-t[1])).map((e=>e[0])).concat(a.slice(32).map((e=>e[0])));B.time.value=e,B.delta.value=t,_.time.value=e,_.delta.value=t,P.time.value=e,P.delta.value=t,P.music.value=N,_.music.value=N,_.lmusic.value=r,P.lmusic.value=r,U.time.value=e,U.delta.value=t,U.music.value=N,U.lmusic.value=r,_.predator.value.set(.5*W/j,-.5*O/k,0),W=1e4,O=1e4,A.compute(),U.texturePosition.value=A.getCurrentRenderTarget(I).texture,U.textureVelocity.value=A.getCurrentRenderTarget(V).texture,U.textureColor.value=A.getCurrentRenderTarget(E).texture,D.render(F,M)}(),S.update()}();
